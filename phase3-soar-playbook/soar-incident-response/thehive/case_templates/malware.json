{
  "name": "Malware Investigation",
  "displayName": "Malware Investigation",
  "description": "Standard investigation template for malware incidents including ransomware, trojans, and suspicious executables.",
  "severity": 3,
  "tlp": 2,
  "pap": 2,
  "flag": true,
  "tags": ["malware", "endpoint", "ransomware"],
  "tasks": [
    {
      "order": 0,
      "title": "Triage — Confirm malware detection",
      "group": "Triage",
      "description": "Verify detection is not a false positive. Check AV alert details, file path, and process tree. Confirm endpoint is compromised.",
      "status": "Waiting",
      "flag": false
    },
    {
      "order": 1,
      "title": "Contain — Isolate affected endpoint",
      "group": "Containment",
      "description": "Immediately isolate the endpoint from the network using EDR containment or manual VLAN switch. Prevent lateral movement.",
      "status": "Waiting",
      "flag": true
    },
    {
      "order": 2,
      "title": "Collect — Memory and disk forensics",
      "group": "Collection",
      "description": "Collect memory dump and disk image before remediation. Preserve process list, network connections, and registry hives.",
      "status": "Waiting",
      "flag": false
    },
    {
      "order": 3,
      "title": "Analyse — Static and dynamic analysis",
      "group": "Analysis",
      "description": "Submit binary to sandbox. Perform static analysis (strings, PE headers, imports). Document C2 IOCs, persistence mechanisms.",
      "status": "Waiting",
      "flag": false
    },
    {
      "order": 4,
      "title": "Analyse — Lateral movement check",
      "group": "Analysis",
      "description": "Review authentication logs, SMB activity, and RDP logs for signs of lateral movement. Check for credential dumping artifacts.",
      "status": "Waiting",
      "flag": false
    },
    {
      "order": 5,
      "title": "Contain — Block C2 infrastructure",
      "group": "Containment",
      "description": "Block identified C2 domains/IPs at firewall and DNS. Submit to threat-intel feeds. Check for other hosts communicating with same C2.",
      "status": "Waiting",
      "flag": false
    },
    {
      "order": 6,
      "title": "Eradicate — Remove malware",
      "group": "Eradication",
      "description": "Remove malware and persistence mechanisms. Rebuild endpoint if rootkit or ransomware is confirmed.",
      "status": "Waiting",
      "flag": false
    },
    {
      "order": 7,
      "title": "Recover — Restore from backup",
      "group": "Recovery",
      "description": "Restore data from last known-good backup. Verify integrity. Reconnect to network after confirming clean.",
      "status": "Waiting",
      "flag": false
    },
    {
      "order": 8,
      "title": "Close — Lessons learned",
      "group": "Closure",
      "description": "Document attack vector, timeline, impact, and remediation. Update detection rules. Submit IOCs to sharing platforms.",
      "status": "Waiting",
      "flag": false
    }
  ],
  "customFields": {
    "caseType": { "type": "string", "value": "malware" },
    "attackVector": { "type": "string", "value": "endpoint" },
    "mitreTechnique": { "type": "string", "value": "T1204 - User Execution" }
  }
}
