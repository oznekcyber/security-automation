{
  "info": {
    "_postman_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
    "name": "Security Integration Hub",
    "description": "Bidirectional API middleware between CrowdStrike Falcon and TheHive",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8000",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Webhooks",
      "item": [
        {
          "name": "POST TheHive Webhook",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/webhooks/thehive",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "webhooks", "thehive"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"operation\": \"Update\",\n  \"objectType\": \"Case\",\n  \"objectId\": \"~12345\",\n  \"object\": {\n    \"sourceRef\": \"ldt:abc123def456abc123def456abc12301:9876543210\",\n    \"status\": \"Resolved\",\n    \"summary\": \"Confirmed malicious activity. Endpoint quarantined.\",\n    \"customFields\": {}\n  }\n}"
            }
          },
          "response": []
        },
        {
          "name": "POST CrowdStrike Webhook",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/webhooks/crowdstrike",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "webhooks", "crowdstrike"]
            },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"event_type\": \"DetectionSummaryEvent\",\n  \"detection\": {\n    \"detection_id\": \"ldt:abc123def456abc123def456abc12301:9876543210\",\n    \"cid\": \"abc123def456abc123def456abc12301\",\n    \"created_timestamp\": \"2024-01-15T08:32:11.000Z\",\n    \"max_severity\": 80,\n    \"max_severity_displayname\": \"Critical\",\n    \"status\": \"new\",\n    \"tactic\": \"Execution\",\n    \"technique\": \"PowerShell\",\n    \"behaviors\": [\n      {\n        \"behavior_id\": \"behav001\",\n        \"tactic\": \"Execution\",\n        \"tactic_id\": \"TA0002\",\n        \"technique\": \"PowerShell\",\n        \"technique_id\": \"T1059.001\",\n        \"severity\": 80,\n        \"confidence\": 90,\n        \"description\": \"Encoded PowerShell reverse shell\",\n        \"filename\": \"powershell.exe\",\n        \"filepath\": \"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\",\n        \"cmdline\": \"powershell.exe -NoProfile -EncodedCommand JABjAGwAaQ==\",\n        \"sha256\": \"a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2c3d4e5f6a1b2\",\n        \"md5\": \"a1b2c3d4e5f6a1b2c3d4e5f6\"\n      }\n    ],\n    \"device\": {\n      \"device_id\": \"dev001abc123def456abc123def456ab\",\n      \"hostname\": \"WORKSTATION-042\",\n      \"local_ip\": \"10.10.5.42\",\n      \"external_ip\": \"203.0.113.42\",\n      \"os_version\": \"Windows 10 Enterprise\",\n      \"platform_name\": \"Windows\"\n    }\n  }\n}"
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Sync",
      "item": [
        {
          "name": "GET Sync Status",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/sync/status",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "sync", "status"]
            }
          },
          "response": []
        },
        {
          "name": "POST Manual Sync",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/sync/manual",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "sync", "manual"]
            },
            "body": {
              "mode": "raw",
              "raw": ""
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Health",
      "item": [
        {
          "name": "GET Health",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/health",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "health"]
            }
          },
          "response": []
        }
      ]
    }
  ]
}
